<div class="announcement-container">
  <img src="images/announcement-banner.png" alt="Announcement Banner" class="welcome-banner" />

  <div class="page-header">
    <h3>Official Announcement</h3>
    <button class="add-button" (click)="toggleAddModal()">+ Add announcement</button>
  </div>

  <div class="announcement-list">
    <div
      class="announcement-item"
      *ngFor="let item of announcements; let i = index"
      (click)="openAnnouncement(item, $event)"
    >
      <img src="images/megaphone-icon.png" alt="Icon" class="item-icon" />

      <div class="item-details">
        <h4>{{ item.title }}</h4>
        <span>{{ item.date }}</span>
        <a
          href="#"
          (click)="downloadFile(item, $event); $event.preventDefault()"
          class="download-link"
        >
          <img src="images/download-blue.png" alt="Download" />
          Download
        </a>
      </div>

      <div class="options-container">
        <button class="options-button" (click)="toggleOptionsMenu(i, $event)">
          <img src="images/dots-blue.png" alt="Options" />
        </button>
        <div class="options-menu" *ngIf="openMenuIndex === i">
          <a href="#" (click)="deleteAnnouncement(i, $event); $event.preventDefault()">Delete</a>
          <hr />
          <a href="#" (click)="openEditModal(i, $event); $event.preventDefault()">Edit</a>
        </div>
      </div>
    </div>
  </div>
</div>

<!-- MODAL FORM -->
<div class="modal-overlay" *ngIf="showAddModal" (click)="toggleAddModal()">
  <form
    class="modal-content"
    (click)="$event.stopPropagation()"
    [formGroup]="announcementForm"
    (ngSubmit)="addAnnouncement()"
  >
    <h3>{{ editIndex !== null ? 'Edit Announcement' : 'Upload Announcement' }}</h3>

    <div class="form-group">
      <label>Add title.. <span>*</span></label>
      <input type="text" formControlName="title" />
    </div>

    <div class="form-group">
      <label>Add description...</label>
      <textarea rows="4" formControlName="description"></textarea>
    </div>

    <div class="form-group">
      <button type="button" class="attachment-button" (click)="fileInput.click()">
        <img src="images/attachment-icon.png" alt="Attach" />
        Add attachment <span>*</span>
      </button>
      <input type="file" #fileInput (change)="onFileSelected($event)" style="display: none" />
      <span class="selected-file-name" *ngIf="selectedFileName">{{ selectedFileName }}</span>
    </div>

    <div class="modal-actions">
      <button type="button" class="cancel-button" (click)="toggleAddModal()">Cancel</button>
      <button type="submit" class="add-button-modal" [disabled]="announcementForm.invalid">
        {{ editIndex !== null ? 'Save Changes' : '+ Add announcement' }}
      </button>
    </div>
  </form>
</div>
